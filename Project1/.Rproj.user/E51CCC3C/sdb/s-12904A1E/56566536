{
    "collab_server" : "",
    "contents" : "########################################################################\n## Reads and converts data from Excel\n########################################################################\nrm( list = ls( all.names = TRUE ) )\nrm( list = objects( all.names = TRUE ) )\n\nsaveCodedData <- function( DataCoded, folderPath, fileName ){\n  filePath <- paste0( folderPath, fileName )\n  save( DataCoded, file = filePath )\n}\n\nreadRawData <- function( folderPath, fileName ){\n  filePath <- paste0( folderPath, fileName )\n  dataRaw <- read.table( file = filePath, header = T, sep = ',', quote = \"\\\"\" )\n  return( dataRaw )\n}\n\ncodeVariable <- function( vectorNum, vectorLevels, vectorLabels ){\n  vectorCoded <- factor( vectorNum, levels = vectorLevels, labels = vectorLabels )\n  return( vectorCoded )\n}\n\ncodeAge <- function( ageRaw ){\n  ageNAList <- c( '4', '-18', '21`', 'freshman', 'Freshman', 'junion', 'senior', 'Twenty years' )\n  ageNum <- as.vector( ageRaw )\n  ageNum[ ageNum %in% ageNAList ] <- NA\n  ageNum <- as.numeric( ageNum )\n  return( ageNum )\n}\n\n########################################################################\n## Load header files and source functions\n########################################################################\nlibrary( RFunctionsSN )\n\n########################################################################\n## Command line arguments for some static variables\n########################################################################\n#ProjectPath <- '~/Stat/Stat_Consulting/TraciSnedden/Project1/'\nProjectPath <- '~/Documents/snandi/Stat/Stat_Consulting/TraciSnedden/Project1/'\n\nDataPath <- paste0( ProjectPath, 'Data/' )\nfileNameData <- 'InjuryDataFinal_TotalDays.csv'\nfileNameCodedData <- 'DataCoded.RData'\nsource( 'Codebook.R' )\n########################################################################\n\nData <- readRawData( folderPath = DataPath, fileName = fileNameData )\n\nData$Q1.1_coded <- codeAge( ageRaw = Data$Q1.1 )\nsummary( Data$Q1.1 )\nsummary( Data$Q1.1_coded )\n\nData$Q1.4_coded <- codeVariable( vectorNum = Data$Q1.4, vectorLevels = Q1.4Levels, vectorLabels = Q1.4Labels )\n\nData$Q1.5_coded <- codeVariable( vectorNum = Data$Q1.5, vectorLevels = Q1.5Levels, vectorLabels = Q1.5Labels )\nData$Q1.5_coded <- as.factor( as.vector( Data$Q1.5_coded ) )\n\nData$Q1.6_coded <- codeVariable( vectorNum = Data$Q1.6, vectorLevels = Q1.6Levels, vectorLabels = Q1.6Labels )\n\nData$Q1.8_coded <- codeVariable( vectorNum = Data$Q1.8, vectorLevels = Q1.8Levels, vectorLabels = Q1.8Labels )\n\nData$Q1.9_coded <- codeVariable( vectorNum = Data$Q1.9, vectorLevels = Q1.9Levels, vectorLabels = Q1.9Labels )\n\nData$Q1.10_coded <- codeVariable( vectorNum = Data$Q1.10, vectorLevels = Q1.10Levels, vectorLabels = Q1.10Labels )\n\nData$Q2.1_coded <- codeVariable( vectorNum = Data$Q2.1, vectorLevels = Q2.1Levels, vectorLabels = Q2.1Labels )\n\nData$Q2.8_coded <- codeVariable( vectorNum = Data$Q2.8, vectorLevels = Q2.8Levels, vectorLabels = Q2.8Labels )\n\nData$Q3.1_coded <- codeVariable( vectorNum = Data$Q3.1, vectorLevels = Q3.1Levels, vectorLabels = Q3.1Labels )\n\nData$Q3.3_coded <- codeVariable( vectorNum = Data$Q3.3, vectorLevels = Q3.3Levels, vectorLabels = Q3.3Labels )\n\nData$Q3.4_coded <- codeVariable( vectorNum = Data$Q3.4, vectorLevels = Q3.4Levels, vectorLabels = Q3.4Labels )\n\ni <- 1\nfor( i in 1:22 ){\n  varName <- paste0( 'Q5.3_', i )\n  varNameCoded <- paste0( varName, '_coded' )\n  Data[, varNameCoded ] <- codeVariable( vectorNum = Data[, varName ], vectorLevels = Q5.3_1Levels, \n                            vectorLabels = Q5.3_1Labels )\n  if( length( table( Data[, varNameCoded] ) ) > 6 ) print( table( Data[, varNameCoded] ) )\n}\n\nfor( i in 1:8 ){\n  varName <- paste0( 'Q7.1_', i )\n  varNameCoded <- paste0( varName, '_coded' )\n  Data[, varNameCoded ] <- codeVariable( vectorNum = Data[, varName ], vectorLevels = Q7.1_1Levels, \n                                         vectorLabels = Q7.1_1Labels )\n  if( length( table( Data[, varNameCoded] ) ) > 3 ) print( table( Data[, varNameCoded] ) )\n}\n\nData$Q4.1_coded <- codeVariable( vectorNum = Data$Q4.1, vectorLevels = Q4.1Levels, vectorLabels = Q4.1Labels )\nData$Q4.3_coded <- codeVariable( vectorNum = Data$Q4.3, vectorLevels = Q4.3Levels, vectorLabels = Q4.3Labels )\nData$Q4.4_coded <- codeVariable( vectorNum = Data$Q4.4, vectorLevels = Q4.4Levels, vectorLabels = Q4.4Labels )\nData$Q4.6_coded <- codeVariable( vectorNum = Data$Q4.6, vectorLevels = Q4.6Levels, vectorLabels = Q4.6Labels )\nData$Q4.8_coded <- codeVariable( vectorNum = Data$Q4.8, vectorLevels = Q4.8Levels, vectorLabels = Q4.8Labels )\nData$Q4.9_coded <- codeVariable( vectorNum = Data$Q4.9, vectorLevels = Q4.9Levels, vectorLabels = Q4.9Labels )\n\nsaveCodedData( DataCoded = Data, folderPath = DataPath, fileName = fileNameCodedData )\n\n",
    "created" : 1490510360634.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "825785412",
    "id" : "56566536",
    "lastKnownWriteTime" : 1490497761,
    "last_content_update" : 1490497761,
    "path" : "~/Documents/snandi/Stat/Stat_Consulting/TraciSnedden/Project1/ReadAndConvertExcelData.R",
    "project_path" : "ReadAndConvertExcelData.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}